<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookVerse - ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏ô‡∏±‡∏Å‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏ô‡∏±‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold text-success fs-3" href="index.html">
                <i class="bi bi-book-half"></i> BookVerse
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item"><a class="nav-link active" href="#">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="discover.html">Discover</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Community</a></li>
                </ul>
                
                <div class="d-flex" id="guest-menu">
                    <a href="login.html" class="btn btn-outline-success me-2 rounded-pill px-4">Login</a>
                    <a href="register.html" class="btn btn-success rounded-pill px-4">Sign Up</a>
                </div>

                <div class="d-flex align-items-center" id="user-menu" style="display: none;">
                    <span class="me-3 text-secondary">
                        ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ, <strong class="text-success" id="user-name-display">User</strong>
                    </span>
                    <a href="dashboard.html" class="btn btn-success btn-sm rounded-pill px-3 me-2">
                        <i class="bi bi-pencil-square"></i> ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ô‡∏¥‡∏¢‡∏≤‡∏¢
                    </a>
                    <button onclick="logout()" class="btn btn-outline-danger btn-sm rounded-pill px-3">
                        <i class="bi bi-box-arrow-right"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <header class="hero-section py-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-3">Welcome to BookVerse:<br>Where Stories Come Alive</h1>
                    <p class="lead text-secondary mb-4">
                        ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¥‡∏™‡∏£‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£ ‡∏£‡πà‡∏ß‡∏°‡∏≠‡πà‡∏≤‡∏ô ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏°‡∏°‡∏π‡∏ô‡∏¥‡∏ï‡∏µ‡πâ‡∏ô‡∏±‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û
                    </p>
                    <a href="register.html" class="btn btn-success btn-lg rounded-pill px-5 shadow-sm">
                        Join Now
                    </a>
                </div>
                <div class="col-lg-6 mt-4 mt-lg-0 text-center">
                    <img src="https://i.pinimg.com/736x/0d/78/ea/0d78eab0dcb10fd051af360e1a8d9315.jpg" class="img-fluid rounded-4" alt="Hero Image">
                </div>
            </div>
        </div>
    </header>

    <section class="py-5 bg-light">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h3 class="fw-bold">üî• Trending Books</h3>
                <a href="discover.html" class="btn btn-sm btn-outline-success rounded-pill">View all</a>
            </div>

            <div class="row g-4" id="trending-container">
                <div class="text-center py-5">
                    <div class="spinner-border text-success" role="status"></div>
                    <p class="mt-2 text-secondary">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥...</p>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>
        // --------------------------------------------------------
        // üîß ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ)
        // --------------------------------------------------------
        
        // 1. ‡∏ß‡∏≤‡∏á URL Google Apps Script ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxelv7qk0JyfK-EBEVZonFi2ISt2PmnFtr6oEhde-Fx3pvTRTWUL4_rJL4kRUgm8faQyg/exec'; 

        // 2. ‡∏£‡∏∞‡∏ö‡∏∏ ID ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å (‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç ID ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
        // ‡πÄ‡∏ä‡πà‡∏ô [1, 3] ‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏•‡πà‡∏° ID 1 ‡πÅ‡∏•‡∏∞ 3
        const showBookIds = [1, 2]; 

        // --------------------------------------------------------

        // ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
        window.onload = function() {
            checkLoginStatus(); // ‡πÄ‡∏ä‡πá‡∏Ñ Login
            loadTrendingBooks(); // ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ID ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        function loadTrendingBooks() {
            const container = document.getElementById('trending-container');
            
            fetch(SCRIPT_URL + '?action=getBooks')
                .then(response => response.json())
                .then(allBooks => {
                    // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏°‡∏µ ID ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏ô showBookIds
                    // ‡πÉ‡∏ä‡πâ parseInt ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏ß‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà
                    const trendingBooks = allBooks.filter(book => showBookIds.includes(parseInt(book.id)));

                    container.innerHTML = ''; // ‡∏•‡πâ‡∏≤‡∏á Loading ‡∏≠‡∏≠‡∏Å

                    if (trendingBooks.length === 0) {
                        container.innerHTML = '<div class="col-12 text-center text-muted">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</div>';
                        return;
                    }

                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                    trendingBooks.forEach(book => {
                        const cardHTML = `
                            <div class="col-md-3 col-6">
                                <div class="card h-100 border-0 shadow-sm card-hover">
                                    <div style="height: 250px; overflow: hidden;" class="card-img-top rounded-top bg-light position-relative">
                                        <img src="${book.image}" class="w-100 h-100 object-fit-cover" alt="${book.title}" onerror="this.src='https://placehold.co/400x600?text=No+Image'">
                                    </div>
                                    <div class="card-body">
                                        <h5 class="card-title fs-6 fw-bold text-truncate">${book.title}</h5>
                                        <p class="card-text text-secondary small mb-1">‡πÇ‡∏î‡∏¢ ${book.author}</p>
                                        <div class="d-flex justify-content-between align-items-center mt-2">
                                            <span class="badge bg-success-subtle text-success">${book.category}</span>
                                            <small class="fw-bold text-success">‡∏ø${book.price}</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                        container.innerHTML += cardHTML;
                    });
                })
                .catch(error => {
                    console.error('Error:', error);
                    container.innerHTML = `<div class="col-12 text-center text-danger">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>`;
                });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Login (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('is_logged_in');
            const userName = localStorage.getItem('user_name');

            const guestMenu = document.getElementById('guest-menu');
            const userMenu = document.getElementById('user-menu');
            const nameDisplay = document.getElementById('user-name-display');

            if (isLoggedIn === 'true' && userName) {
                guestMenu.style.display = 'none';
                userMenu.style.display = 'flex';
                nameDisplay.textContent = userName;
            } else {
                guestMenu.style.display = 'flex';
                userMenu.style.display = 'none';
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
        function logout() {
            localStorage.removeItem('is_logged_in');
            localStorage.removeItem('user_name');
            location.reload();
        }
    </script>
</body>
</html>